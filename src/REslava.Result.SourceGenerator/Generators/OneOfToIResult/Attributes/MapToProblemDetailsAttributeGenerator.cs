using Microsoft.CodeAnalysis.Text;
using REslava.Result.SourceGenerators.Core.Interfaces;
using System.Text;

namespace REslava.Result.SourceGenerators.Generators.OneOfToIResult.Attributes
{
    /// <summary>
    /// Generates the MapToProblemDetails attribute for OneOf to IResult conversion.
    /// Shared across all OneOf arities.
    /// </summary>
    public class MapToProblemDetailsAttributeGenerator : IAttributeGenerator
    {
        public SourceText GenerateAttribute()
        {
            var source = @"
using System;

namespace REslava.Result.SourceGenerators.OneOf
{
    /// <summary>
    /// Maps error types to HTTP status codes for OneOf to IResult conversion.
    /// Generated by REslava.Result.SourceGenerators.
    /// </summary>
    [AttributeUsage(AttributeTargets.Class | AttributeTargets.Struct, AllowMultiple = true)]
    public class MapToProblemDetailsAttribute : Attribute
    {
        /// <summary>
        /// Gets or sets the HTTP status code to return when this error type is encountered.
        /// </summary>
        public int StatusCode { get; set; }

        /// <summary>
        /// Gets or sets the custom title for the ProblemDetails.
        /// </summary>
        public string? Title { get; set; }

        /// <summary>
        /// Gets or sets the custom detail for the ProblemDetails.
        /// </summary>
        public string? Detail { get; set; }

        /// <summary>
        /// Gets or sets the custom type for the ProblemDetails.
        /// </summary>
        public string? Type { get; set; }
    }
}";

            return SourceText.From(source, Encoding.UTF8);
        }
    }
}
